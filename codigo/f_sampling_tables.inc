; Tablas para los valores utilizados en:
; -Contador de interrupciones de CTC del timer0 para frecuencia de muestreo
; 
; -Numerador para aproximar divisiones como cociente entre
;  dicho numerador y un divisor potencia de 2. Esta especificamente
;  disenado para utilizarlo en la obtencion de error integral. 
;  Se incluye el efecto extra de un divisor KI_ADDITIONAL_DIVISION
;  que atenua el valor tal de poder utilizar valores
;  de KI pequenos.
;
;  Solo es necesario cambiar las constantes de compilacion, no hace falta
;  generar las tablas. 
;
; Las tablas se introducen al final de la memoria FLASH.

.equ MIN_SAMPLE_FREQ = 1
.equ MAX_SAMPLE_FREQ = 16
.equ TABLE_SIZE_WORDS = MAX_SAMPLE_FREQ + 1

.equ TIMER0_PRESCALER = 8
.equ F_CLOCK = 16000000
.equ OCR0A_VALUE = 250
.equ T0_CTC_FREQ_INTERRUPT = F_CLOCK / (TIMER0_PRESCALER * OCR0A_VALUE)  

.equ DENOMINATOR_APPROX = 4096
.equ N_BITSHIFT_DIVISION = log2(DENOMINATOR_APPROX)
.equ KI_ADDITIONAL_DIVISION = 10


.cseg
.org(FLASHEND/2 - 2*(TABLE_SIZE_WORDS) )
	TABLA_CONTADOR_CTC_FREC_MUESTREO: .dw 0, (T0_CTC_FREQ_INTERRUPT / 1), \
	(T0_CTC_FREQ_INTERRUPT / 2), (T0_CTC_FREQ_INTERRUPT / 3), \
	(T0_CTC_FREQ_INTERRUPT / 4), (T0_CTC_FREQ_INTERRUPT / 5), \
	(T0_CTC_FREQ_INTERRUPT / 6), (T0_CTC_FREQ_INTERRUPT / 7), \
	(T0_CTC_FREQ_INTERRUPT / 8), (T0_CTC_FREQ_INTERRUPT / 9), \
	(T0_CTC_FREQ_INTERRUPT / 10), (T0_CTC_FREQ_INTERRUPT / 11), \
	(T0_CTC_FREQ_INTERRUPT / 12), (T0_CTC_FREQ_INTERRUPT / 13), \
	(T0_CTC_FREQ_INTERRUPT / 14), (T0_CTC_FREQ_INTERRUPT / 15), \
	(T0_CTC_FREQ_INTERRUPT / 16)


.org(FLASHEND/2 - (TABLE_SIZE_WORDS) )
NUMERATOR_APPROX_TABLE: .dw 0, (DENOMINATOR_APPROX/KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(2*KI_ADDITIONAL_DIVISION), DENOMINATOR_APPROX/(3*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(4*KI_ADDITIONAL_DIVISION), DENOMINATOR_APPROX/(5*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(6*KI_ADDITIONAL_DIVISION),DENOMINATOR_APPROX/(7*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(8*KI_ADDITIONAL_DIVISION),DENOMINATOR_APPROX/(9*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(10*KI_ADDITIONAL_DIVISION),DENOMINATOR_APPROX/(11*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(12*KI_ADDITIONAL_DIVISION),DENOMINATOR_APPROX/(13*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(14*KI_ADDITIONAL_DIVISION),DENOMINATOR_APPROX/(15*KI_ADDITIONAL_DIVISION), \
	DENOMINATOR_APPROX/(16*KI_ADDITIONAL_DIVISION) 
